<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="comn">

	<select id="getCmnCd" parameterType="hashmap" resultMap="dsCmnCd">
		SELECT B.WRK_MDUL_CD
			 , B.COMM_CTG_CD
			 , A.COMM_CTG_NM
			 , B.COMM_CTG_DTL_CD
			 , B.COMM_CTG_DTL_NM
			 , B.COMM_PROP_CONT_01
			 , B.COMM_PROP_CONT_02
			 , B.COMM_PROP_CONT_03
			 , B.COMM_PROP_CONT_04
			 , B.COMM_PROP_CONT_05
			 , B.COMM_PROP_CONT_06
			 , B.COMM_PROP_CONT_07
			 , B.COMM_PROP_CONT_08
			 , B.COMM_PROP_CONT_09
			 , B.COMM_PROP_CONT_10
		  FROM MAST001M A
		 INNER
		  JOIN MAST001D B
		    ON A.WRK_MDUL_CD = B.WRK_MDUL_CD
		   AND A.COMM_CTG_CD = B.COMM_CTG_CD
		 WHERE A.USE_YN 	 = 'Y'
		   AND B.USE_YN 	 = 'Y'
		   AND A.WRK_MDUL_CD = #{p_wrk_mdul_cd}
		<if test='p_comm_ctg_cd != null and p_comm_ctg_cd !=""'>
		   AND B.COMM_CTG_CD IN 
			<foreach collection="p_comm_ctg_cd" item="item" open="(" close=")" separator=",">
				#{item}
			</foreach>		
		</if>
	  ORDER BY A.SORT_NO, B.SORT_NO
	</select>
	<resultMap id="dsCmnCd" type="hashmap">
		<id property="mdul_cd" column="WRK_MDUL_CD" />
		<collection property="hdr" javaType="java.util.List" ofType="hashmap">
			<id property="ctg_cd" column="COMM_CTG_CD" />
			<result property="ctg_nm" column="COMM_CTG_NM" />
			<collection property="dtl" javaType="java.util.List" ofType="hashmap">
				<id property="ctg_dtl_cd" column="COMM_CTG_DTL_CD" />
				<result property="ctg_dtl_nm" column="COMM_CTG_DTL_NM" />
				<result property="attr_1" column="COMM_PROP_CONT_01" />
				<result property="attr_2" column="COMM_PROP_CONT_02" />
				<result property="attr_3" column="COMM_PROP_CONT_03" />
				<result property="attr_4" column="COMM_PROP_CONT_04" />
				<result property="attr_5" column="COMM_PROP_CONT_05" />
				<result property="attr_6" column="COMM_PROP_CONT_06" />
				<result property="attr_7" column="COMM_PROP_CONT_07" />
				<result property="attr_8" column="COMM_PROP_CONT_08" />
				<result property="attr_9" column="COMM_PROP_CONT_09" />
				<result property="attr_10" column="COMM_PROP_CONT_10" />
			</collection>
		</collection>
	</resultMap>

</mapper>